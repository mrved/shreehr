---
phase: 05-supporting-workflows
plan: 06
type: execute
wave: 3
depends_on: ["05-04", "05-05"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All three workflows function end-to-end"
    - "Payroll correctly includes expense reimbursements and loan deductions"
    - "UI is usable on both desktop and mobile"
---

<objective>
Verify all supporting workflows function correctly end-to-end: onboarding creation to completion, expense submission through reimbursement, and loan creation through EMI deduction.

Purpose: Ensure Phase 5 success criteria are met before marking phase complete.

Output: Verified working workflows, any issues documented for follow-up.
</objective>

<execution_context>
@C:\Users\ved\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\ved\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete onboarding workflow with checklist management</what-built>
  <how-to-verify>
1. Log in as HR_MANAGER
2. Navigate to /onboarding
3. Click "New Onboarding" and fill in candidate details:
   - Name: Test Candidate
   - Email: test@example.com
   - Phone: 9876543210
   - Select a designation and department
   - Set joining date to next week
   - Review default checklist items
4. Submit the form - should create record and show success
5. View the new onboarding record
6. Mark one checklist item as complete
7. Verify progress bar updates
8. Test status transition buttons (if available)
  </how-to-verify>
  <resume-signal>Type "approved" if onboarding works, or describe issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete expense workflow with multi-level approval</what-built>
  <how-to-verify>
1. Log in as an EMPLOYEE
2. Navigate to employee portal /expenses
3. Click "Submit Expense" and create a claim:
   - Select a category
   - Enter amount (try both below and above manager limit Rs.500)
   - Upload a receipt image
   - Submit the expense
4. Verify receipt was uploaded
5. Submit the draft for approval
6. Log in as the employee's MANAGER
7. Navigate to /expenses and check "Pending Approval" tab
8. Approve the expense claim
9. If amount was above Rs.500, log in as HR_MANAGER and approve at level 2
10. Verify expense status changes to APPROVED
  </how-to-verify>
  <resume-signal>Type "approved" if expenses work, or describe issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete loan workflow with EMI calculation and schedule</what-built>
  <how-to-verify>
1. Log in as ADMIN
2. Navigate to /loans
3. Click "Create Loan" and fill in:
   - Select an employee
   - Type: PERSONAL
   - Principal: Rs.100,000
   - Interest: 12%
   - Tenure: 12 months
   - Start date: next month
4. Verify EMI preview shows ~Rs.8,885 and total interest ~Rs.6,618
5. Submit the loan
6. View the loan detail page
7. Check the amortization schedule - verify 12 months shown
8. Click "Disburse" to activate the loan
9. Log in as the employee
10. Navigate to employee portal /loans
11. Verify loan appears with correct details
12. View the repayment schedule
  </how-to-verify>
  <resume-signal>Type "approved" if loans work, or describe issues found</resume-signal>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Payroll integration with expense reimbursement and loan deduction</what-built>
  <how-to-verify>
1. Ensure there's an approved expense and an active loan for an employee
2. Log in as PAYROLL_MANAGER
3. Navigate to /payroll/run
4. Run payroll for the current month
5. After payroll completes, view the payroll record for the employee with expense/loan
6. Verify:
   - Reimbursements amount shows the approved expense amount
   - Loan deductions amount shows the EMI amount
   - Net salary = gross - deductions + reimbursements - loan_emi
7. Check the expense claim - should now be status REIMBURSED
8. Check the loan deduction record - should be status DEDUCTED
9. Check loan remaining balance - should be decreased by principal amount
  </how-to-verify>
  <resume-signal>Type "approved" if payroll integration works, or describe issues found</resume-signal>
</task>

</tasks>

<verification>
All checkpoints passed with user approval.
</verification>

<success_criteria>
- User confirms onboarding workflow works
- User confirms expense workflow with approval works
- User confirms loan workflow with EMI calculation works
- User confirms payroll integration correctly processes expenses and loans
</success_criteria>

<output>
After completion, create `.planning/phases/05-supporting-workflows/05-06-SUMMARY.md`
</output>
